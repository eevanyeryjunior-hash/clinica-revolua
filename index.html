<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>REVOLUA - Drª Lucelia Silvana & Drª Karina Lima</title>
  <style>
    /* Reset e base */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body, html {
      height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: url('fundo-fisio.png') no-repeat center center fixed;
      background-size: contain;
      background-color: #121212;
      color: #ddd;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    body::before {
      content: "";
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(18, 18, 18, 0.85);
      z-index: -1;
    }
    header {
      background-color: rgba(25, 25, 25, 0.95);
      padding: 15px 20px;
      text-align: center;
      border-bottom: 2px solid #1DB954;
    }
    header h1 { color: #1DB954; font-size: 2.8rem; margin-bottom: 6px; letter-spacing: 2px; }
    header p { color: #bbb; font-size: 1rem; font-weight: 600; }
    nav {
      background-color: rgba(20, 20, 20, 0.9);
      padding: 10px 0;
      box-shadow: 0 2px 8px #0008;
      margin-bottom: 30px;
    }
    nav ul {
      list-style: none;
      display: flex;
      justify-content: center;
      gap: 25px;
      font-weight: 600;
      font-size: 1.1rem;
      color: #ccc;
    }
    nav ul li:hover { color: #1DB954; cursor: pointer; transition: color 0.3s ease; }
    nav ul li a { color: #ccc; transition: color 0.3s ease; }
    nav ul li a:hover { color: #1DB954; }
    main { flex: 1; max-width: 1100px; margin: 0 auto 50px; padding: 0 20px; }
    .doutoras {
      display: flex; gap: 40px; flex-wrap: wrap; justify-content: center; margin-bottom: 50px;
    }
    .doutora {
      background: rgba(30, 30, 30, 0.9);
      border-radius: 15px;
      box-shadow: 0 8px 25px #000;
      width: 320px;
      padding: 20px;
      color: #eee;
      text-align: center;
      transition: transform 0.3s ease;
    }
    .doutora:hover { transform: translateY(-10px); box-shadow: 0 12px 35px #1DB954aa; }
    .doutora img {
      width: 180px; height: 180px; object-fit: cover; border-radius: 50%;
      margin-bottom: 15px; border: 3px solid #1DB954;
    }
    .doutora h2 { color: #1DB954; margin-bottom: 10px; font-size: 1.8rem; }
    .doutora p { font-size: 1rem; margin-bottom: 7px; font-style: italic; }
    .consultas {
      background: rgba(25, 25, 25, 0.95);
      padding: 25px 30px;
      border-radius: 20px;
      box-shadow: 0 10px 30px #000000cc;
      margin-bottom: 50px;
      color: #ddd;
    }
    .consultas h2 { color: #1DB954; margin-bottom: 20px; font-size: 2rem; text-align: center; }
    .consultas ul {
      list-style: none;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 15px;
    }
    .consultas li {
      background: #222;
      border-radius: 12px;
      padding: 12px 15px;
      box-shadow: 0 4px 10px #000;
      text-align: center;
      font-weight: 600;
      transition: background-color 0.3s ease;
      cursor: pointer;
    }
    .consultas li:hover {
      background-color: #1DB954;
      color: #121212;
      font-weight: 700;
      box-shadow: 0 8px 18px #1DB954cc;
    }
    .agendamento {
      background: rgba(20, 20, 20, 0.95);
      padding: 25px 30px;
      border-radius: 20px;
      box-shadow: 0 10px 30px #000000cc;
      max-width: 600px;
      margin: 0 auto 60px;
      color: #ddd;
    }
    .agendamento h2 { color: #1DB954; margin-bottom: 20px; text-align: center; font-size: 2rem; }
    .agendamento form { display: flex; flex-direction: column; gap: 15px; }
    .agendamento label { font-weight: 600; }
    .agendamento input, .agendamento select {
      padding: 10px 12px;
      border-radius: 10px; border: none; font-size: 1rem;
      background-color: #333; color: #eee;
      transition: background-color 0.3s ease;
    }
    .agendamento input:focus, .agendamento select:focus { background-color: #444; outline: none; }
    .agendamento button {
      background-color: #1DB954; border: none;
      padding: 14px; font-size: 1.1rem; font-weight: 700;
      border-radius: 12px; color: #121212; cursor: pointer;
      transition: background-color 0.3s ease; margin-top: 10px;
    }
    .agendamento button:hover { background-color: #17a34a; }
    .agendamento .msg { margin-top: 10px; font-weight: 700; text-align: center; }
    #contato {
      max-width: 900px; margin: 0 auto 60px; padding: 20px;
      background-color: rgba(25, 25, 25, 0.95);
      border-radius: 15px;
      box-shadow: 0 8px 24px #000000cc;
      color: #BBBBBB;
      text-align: center;
    }
    #contato h2 { color: #1DB954; margin-bottom: 20px; font-size: 2rem; }
    .mapa iframe { width: 100%; height: 320px; border-radius: 15px; box-shadow: 0 4px 15px #000000cc; border: none; }
    #contato p { margin: 8px 0; font-weight: 600; }
    #contato a { color: #1DB954; text-decoration: none; font-weight: 600; }
    #contato a:hover { text-decoration: underline; }
    footer {
      background-color: #121212;
      text-align: center;
      padding: 20px 10px;
      font-size: 0.9rem;
      color: #666666;
      border-top: 1px solid #222;
      margin-top: auto;
    }
    @media (max-width: 768px) {
      .doutoras { flex-direction: column; align-items: center; }
      nav ul { flex-direction: column; gap: 15px; }
      .consultas ul { grid-template-columns: 1fr; }
    }
    a { color: #1DB954; text-decoration: none; font-weight: 600; }
    a:hover { text-decoration: underline; color: #17a34a; }
    .doutora a[href*="wa.me"] { color: #25D366; }
    .doutora a[href*="wa.me"]:hover { color: #1DA851; }

    /* Estilo da lista de agendamentos */
    #lista-agendamentos-container {
      background: rgba(30, 30, 30, 0.9);
      border-radius: 20px;
      padding: 20px 30px;
      max-width: 900px;
      margin: 0 auto 50px;
      box-shadow: 0 10px 30px #000000cc;
      color: #ddd;
    }
    #lista-agendamentos-container h2 {
      color: #1DB954;
      margin-bottom: 15px;
      text-align: center;
    }
    #lista-agendamentos-container table {
      width: 100%;
      border-collapse: collapse;
    }
    #lista-agendamentos-container th, #lista-agendamentos-container td {
      padding: 10px;
      border-bottom: 1px solid #444;
      text-align: center;
    }
    #lista-agendamentos-container th {
      background-color: #1DB954;
      color: #121212;
      font-weight: 700;
    }
    #btnLimpar {
      margin-top: 15px;
      background-color: #d9534f;
      color: #fff;
      border: none;
      padding: 12px 20px;
      border-radius: 12px;
      font-weight: 700;
      cursor: pointer;
      display: block;
      width: 100%;
      transition: background-color 0.3s ease;
    }
    #btnLimpar:hover {
      background-color: #c9302c;
    }
  </style>
</head>
<body>
  <header>
    <h1>REVOLUA</h1>
    <p>Drª Lucelia Silvana & Drª Karina Lima</p>
  </header>
  <nav>
    <ul>
      <li><a href="#doutoras">Doutoras</a></li>
      <li><a href="#consultas">Consultas</a></li>
      <li><a href="#agendamento">Agendamento</a></li>
      <li><a href="#contato">Contato</a></li>
    </ul>
  </nav>
  <main>
    <section class="doutoras" id="doutoras">
      <article class="doutora">
        <img src="lucelia.png" alt="Foto da Drª Lucelia Silvana" />
        <h2>Drª Lucelia Silvana</h2>
        <p>Fisioterapeuta com 15 anos de experiência</p>
        <p>Especialista em reabilitação neurológica</p>
        <p><a href="https://wa.me/5547999999999" target="_blank" rel="noopener noreferrer">WhatsApp</a></p>
      </article>
      <article class="doutora">
        <img src="karina.png" alt="Foto da Drª Karina Lima" />
        <h2>Drª Karina Lima</h2>
        <p>Fisioterapeuta com 12 anos de experiência</p>
        <p>Especialista em fisioterapia respiratória</p>
        <p><a href="https://wa.me/5547988888888" target="_blank" rel="noopener noreferrer">WhatsApp</a></p>
      </article>
    </section>

    <section class="consultas" id="consultas">
      <h2>Consultas Disponíveis</h2>
      <ul>
        <li>Fisioterapia Neurológica</li>
        <li>Fisioterapia Respiratória</li>
        <li>Reabilitação Pós-Cirúrgica</li>
        <li>Tratamento de Dor Crônica</li>
        <li>Alongamento e Fortalecimento</li>
      </ul>
    </section>

    <section class="agendamento" id="agendamento">
      <h2>Agendar Consulta</h2>
      <form id="form-agendamento">
        <label for="doutora">Doutora:</label>
        <select name="doutora" id="selectDoutora" required>
          <option value="" disabled selected>Selecione a doutora</option>
          <option value="Lucelia Silvana">Drª Lucelia Silvana</option>
          <option value="Karina Lima">Drª Karina Lima</option>
        </select>

        <label for="data">Data:</label>
        <input type="date" id="inputData" name="data" min="" required />

        <label for="hora">Hora:</label>
        <select name="hora" id="selectHora" required>
          <option value="" disabled selected>Selecione o horário</option>
        </select>

        <button type="submit">Agendar</button>
        <div class="msg" id="msg"></div>
      </form>
    </section>

    <section id="lista-agendamentos-container">
      <h2>Agendamentos Confirmados</h2>
      <table id="lista-agendamentos">
        <thead>
          <tr>
            <th>Doutora</th>
            <th>Data</th>
            <th>Hora</th>
          </tr>
        </thead>
        <tbody>
          <!-- Agendamentos serão inseridos aqui -->
        </tbody>
      </table>
      <button id="btnLimpar">Limpar Todos Agendamentos</button>
    </section>

    <section id="contato">
      <h2>Contato</h2>
      <p>Rua Exemplo, 123 - Centro, Cidade - Estado</p>
      <p>Telefone: (47) 99999-9999</p>
      <p>Email: contato@revolua.com.br</p>
      <div class="mapa">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3674.123456789!2d-48.999999!3d-26.999999!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x94de123456789abc%3A0x123456789abcdef0!2sRevolua!5e0!3m2!1spt-BR!2sbr!4v1234567890"
          allowfullscreen=""
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
        ></iframe>
      </div>
    </section>
  </main>

  <footer>
    <p>© 2025 Revolua - Todos os direitos reservados</p>
  </footer>

  <script>
    // Lista dos horários disponíveis
    const horarios = [
      '08:00', '08:30', '09:00', '09:30',
      '10:00', '10:30', '11:00', '11:30',
      '13:00', '13:30', '14:00', '14:30',
      '15:00', '15:30', '16:00', '16:30',
      '17:00', '17:30', '18:00'
    ];

    // Referências DOM
    const form = document.getElementById('form-agendamento');
    const inputData = document.getElementById('inputData');
    const selectHora = document.getElementById('selectHora');
    const msg = document.getElementById('msg');
    const listaAgendamentosTbody = document.querySelector('#lista-agendamentos tbody');
    const btnLimpar = document.getElementById('btnLimpar');
    const selectDoutora = document.getElementById('selectDoutora');

    // Ajustar data mínima para hoje no campo date
    function ajustarDataMinima() {
      const hoje = new Date();
      const ano = hoje.getFullYear();
      const mes = String(hoje.getMonth() + 1).padStart(2, '0');
      const dia = String(hoje.getDate()).padStart(2, '0');
      inputData.min = `${ano}-${mes}-${dia}`;
      inputData.value = `${ano}-${mes}-${dia}`;
    }

    ajustarDataMinima();

    // Função para obter agendamentos do localStorage
    function getAgendamentos() {
      const dados = localStorage.getItem('agendamentos');
      return dados ? JSON.parse(dados) : [];
    }

    // Salvar agendamentos no localStorage
    function salvarAgendamentos(agendamentos) {
      localStorage.setItem('agendamentos', JSON.stringify(agendamentos));
    }

    // Atualizar opções de horário com base no doutora, data e horário atual de Brasília
    function atualizarHorarios() {
      const dataSelecionada = inputData.value;
      const doutora = selectDoutora.value;
      const agendamentos = getAgendamentos();

      selectHora.innerHTML = '<option value="" disabled selected>Selecione o horário</option>';

      if (!dataSelecionada || !doutora) return;

      // Obter hora atual em Brasília (UTC-3)
      const agora = new Date();
      // Ajusta para UTC-3 de forma correta (considerando o fuso do navegador)
      const utc = agora.getTime() + (agora.getTimezoneOffset() * 60000);
      const offsetBrasilia = -3 * 60; // em minutos
      const brasilia = new Date(utc + (offsetBrasilia * 60000));
      const hojeBrasilia = brasilia.toISOString().split('T')[0];
      const horaAtualBrasilia = brasilia.getHours();
      const minutoAtualBrasilia = brasilia.getMinutes();

      horarios.forEach(hora => {
        const option = document.createElement('option');
        option.value = hora;
        option.textContent = hora;

        // Verifica se o horário está ocupado para a doutora e data selecionada
        const ocupado = agendamentos.some(a =>
          a.data === dataSelecionada &&
          a.hora === hora &&
          a.doutora === doutora
        );

        // Extrai hora e minutos da string "HH:MM"
        const [h, m] = hora.split(':').map(Number);

        // Verifica se o horário já passou no dia atual (considerando hora e minuto)
        let horarioPassadoHoje = false;
        if (dataSelecionada === hojeBrasilia) {
          if (h < horaAtualBrasilia) {
            horarioPassadoHoje = true;
          } else if (h === horaAtualBrasilia && m <= minutoAtualBrasilia) {
            horarioPassadoHoje = true;
          }
        }

        if (ocupado || horarioPassadoHoje) {
          option.disabled = true;
          option.textContent += ' (Indisponível)';
        }

        selectHora.appendChild(option);
      });
    }

    // Atualiza a lista de agendamentos exibida na tabela
    function atualizarListaAgendamentos() {
      const agendamentos = getAgendamentos();

      listaAgendamentosTbody.innerHTML = '';

      if (agendamentos.length === 0) {
        const tr = document.createElement('tr');
        const td = document.createElement('td');
        td.colSpan = 3;
        td.textContent = 'Nenhum agendamento encontrado.';
        td.style.fontStyle = 'italic';
        tr.appendChild(td);
        listaAgendamentosTbody.appendChild(tr);
        return;
      }

      agendamentos.forEach(a => {
        const tr = document.createElement('tr');
        const tdDoutora = document.createElement('td');
        tdDoutora.textContent = a.doutora;
        const tdData = document.createElement('td');
        tdData.textContent = a.data.split('-').reverse().join('/'); // Formata DD/MM/AAAA
        const tdHora = document.createElement('td');
        tdHora.textContent = a.hora;
        tr.appendChild(tdDoutora);
        tr.appendChild(tdData);
        tr.appendChild(tdHora);
        listaAgendamentosTbody.appendChild(tr);
      });
    }

    // Limpar todos os agendamentos com confirmação
    btnLimpar.addEventListener('click', () => {
      if (confirm('Tem certeza que deseja limpar todos os agendamentos? Esta ação não pode ser desfeita.')) {
        localStorage.removeItem('agendamentos');
        atualizarListaAgendamentos();
        atualizarHorarios();
        msg.textContent = 'Todos os agendamentos foram removidos.';
        msg.style.color = '#1DB954';
      }
    });

    // Atualizar horários quando data ou doutora mudarem
    inputData.addEventListener('change', atualizarHorarios);
    selectDoutora.addEventListener('change', atualizarHorarios);

    // Manipulação do formulário de agendamento
    form.addEventListener('submit', (event) => {
      event.preventDefault();

      const doutora = selectDoutora.value;
      const data = inputData.value;
      const hora = selectHora.value;

      if (!doutora || !data || !hora) {
        msg.textContent = 'Por favor, preencha todos os campos.';
        msg.style.color = '#d9534f';
        return;
      }

      const agendamentos = getAgendamentos();

      // Verificar se o horário já está agendado
      const jaAgendado = agendamentos.some(a =>
        a.doutora === doutora &&
        a.data === data &&
        a.hora === hora
      );

      if (jaAgendado) {
        msg.textContent = 'Este horário já está reservado. Por favor, escolha outro.';
        msg.style.color = '#d9534f';
        return;
      }

      // Verificar se o horário já passou (considerando horário Brasília)
      const agora = new Date();
      const utc = agora.getTime() + (agora.getTimezoneOffset() * 60000);
      const offsetBrasilia = -3 * 60;
      const brasilia = new Date(utc + (offsetBrasilia * 60000));
      const hojeBrasilia = brasilia.toISOString().split('T')[0];
      const horaAtualBrasilia = brasilia.getHours();
      const minutoAtualBrasilia = brasilia.getMinutes();

      const [h, m] = hora.split(':').map(Number);

      if (data === hojeBrasilia) {
        if (h < horaAtualBrasilia || (h === horaAtualBrasilia && m <= minutoAtualBrasilia)) {
          msg.textContent = 'Não é possível agendar um horário que já passou.';
          msg.style.color = '#d9534f';
          return;
        }
      } else {
        // Também impede agendamento para datas anteriores a hoje
        if (data < hojeBrasilia) {
          msg.textContent = 'Não é possível agendar para uma data passada.';
          msg.style.color = '#d9534f';
          return;
        }
      }

      // Salvar novo agendamento
      agendamentos.push({ doutora, data, hora });
      salvarAgendamentos(agendamentos);

      // Limpar e atualizar a interface
      msg.textContent = `Consulta agendada com sucesso para ${data.split('-').reverse().join('/')} às ${hora} com ${doutora}.`;
      msg.style.color = '#1DB954';

      form.reset();
      ajustarDataMinima();
      atualizarHorarios();
      atualizarListaAgendamentos();
    });

    // Inicializa lista e horários ao carregar a página
    window.addEventListener('load', () => {
      ajustarDataMinima();
      atualizarHorarios();
      atualizarListaAgendamentos();
    });
  </script>
</body>
</html>
